---
id: "3e60"
status: open
deps: [e756]
links: []
created: 2026-02-14T11:59:38Z
type: task
priority: 2
---
# kd chat: interactive multi-agent chat TUI (Phase 2)

## Description

Build a dedicated Textual app for interactive council chat, designed to run in a separate terminal pane alongside Claude Code. Instead of `kd council ask` (fire-and-forget), this is a persistent chat room where messages stream in with color-coded panels per member.

Scope: Phase 2 only (basic TUI + streaming). Group chat auto-mode / orchestration (Phase 3) is deferred â€” will be ticketed after dogfooding Phase 2.

## Acceptance Criteria

- [ ] `kd chat` resumes the current thread; `kd chat --new` creates a fresh thread
- [ ] Messages sent to all council members by default (`@all` explicit broadcast)
- [ ] `@member` addressing for directed messages
- [ ] Responses stream into color-coded panels by tailing `.stream-{member}.jsonl` files
- [ ] Extract `text_delta` text from NDJSON lines; replace with parsed response when finalized message file lands
- [ ] Chat history persists in the thread system (`kd council show` compatible)
- [ ] Slash commands: `/mute <member>`, `/unmute <member>` (session-scoped), `/help`, `/quit`
- [ ] Textual is an optional dependency (`uv add --optional tui textual`); `kd chat` shows install hint if not available
- [ ] Bridge Textual's asyncio event loop to blocking subprocess queries via `asyncio.to_thread()`

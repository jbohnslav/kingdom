---
from: king
to: all
timestamp: 2026-02-13T23:10:27Z
---

We're rethinking kd done and the archive workflow. The current problem: kd done moves .kd/branches/<name>/ to .kd/archive/<name>/, which creates uncommitted file changes. If you're on master with branch protection, you can't commit those changes. Auto-committing on master isn't viable in a real codebase.

We're considering: make archive a status field in state.json instead of a directory move. 'kd done' just sets status: done, clears the session pointer, and removes worktrees. No files move. But the concern is: .kd/branches/ will accumulate done branches forever, cluttering the directory.

How should we handle this? Some options:
1. Status-only (no move), accept the clutter, maybe add 'kd gc' to prune old done branches later
2. Status-only, but gitignore .kd/archive/ and move done branches there as a local-only cleanup
3. Run kd done on the feature branch before merge so archive changes come in with the PR
4. Something else entirely

Weigh the tradeoffs. What's the right design?

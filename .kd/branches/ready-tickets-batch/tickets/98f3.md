---
id: 98f3
status: closed
deps: []
links: []
created: 2026-02-14T02:28:59Z
type: bug
priority: 2
---
# kd tk move should remove ticket from source location

When moving a ticket (e.g. from backlog to a branch), the source copy is left behind, causing duplicate ID matches on partial lookups. The move command should delete the original file after copying to the destination.

## Implementation Notes (council)

**Key files:** `src/kingdom/ticket.py` (`move_ticket` ~L362-383), `src/kingdom/cli.py` (`ticket_move` ~L2473-2538)

**Approach:**
- Investigate first: `move_ticket()` already uses `Path.rename()` which is an atomic move that should remove the source
- The bug may be in the CLI layer where `find_ticket()` finds a backlog copy and the branch copy, or the move is using `shutil.copy` somewhere instead of rename
- If `Path.rename()` is failing silently (cross-filesystem), add `shutil.move()` as fallback
- Consider using `git mv` to preserve history and update the git index

**Gotchas:**
- `find_ticket()` searches multiple locations — the "source" might not be what you expect
- Cross-filesystem `Path.rename()` raises `OSError` — may need `shutil.move()` fallback
- Verify: is the bug that find_ticket returns the backlog match, copies to branch, but backlog copy persists?

## Worklog

- Already fixed in commit f208bb7 — `move_ticket()` has try/except around `Path.rename()` with `shutil.copy2()` + `unlink()` fallback for cross-filesystem moves. Test coverage exists (`test_move_cross_filesystem_fallback`). CLI tests verify source removal. No work needed.

---
from: king
to: peasant-kin-0984
timestamp: 2026-02-10T15:02:03Z
---

# Starting work on kin-0984

**Title:** Add file locking to session state read-modify-write

update_agent_state in session.py does get + modify + set without locking. The harness and CLI can both write to the same session JSON concurrently. Add fcntl.flock or atomic rename to prevent TOCTOU races.

---
id: "a6a6"
status: open
deps: []
links: []
created: 2026-02-16T13:25:21Z
type: task
priority: 2
---
# Enable Cursor partial stream output in kd chat

## Context

`kd chat` requests streaming for all members, but Cursor currently may emit little/no incremental text during a run. This makes `StreamingPanel` appear stagnant for Cursor compared with Claude/Codex.

Cursor CLI exposes `--stream-partial-output` for `--print --output-format stream-json` mode. We should explicitly use it in our Cursor command builder for streaming queries.

## Acceptance Criteria

- [ ] `build_cursor_command(..., streaming=True)` adds `--stream-partial-output`
- [ ] `build_cursor_command(..., streaming=False)` does not add `--stream-partial-output`
- [ ] Existing Cursor command semantics remain unchanged (`--mode ask`, model, resume, extra flags)
- [ ] TUI behavior verified manually: Cursor panel receives incremental stream deltas during active response (not only final message jump)
- [ ] Tests added/updated for command construction behavior

## Worklog

- 2026-02-16: Ticket opened after dogfooding `kd chat` and observing weak/non-incremental Cursor streaming despite active stream lifecycle.
- 2026-02-16: Research sweep:
  - Official Cursor output-format docs confirm `stream-json` NDJSON event stream and assistant text reconstruction model: https://docs.cursor.com/en/cli/reference/output-format
  - Official Cursor CLI usage/headless docs confirm `--print` scripting path used by `kd`: https://docs.cursor.com/en/cli/using and https://docs.cursor.com/en/cli/headless
  - Local CLI help (current installed `agent`) lists `--stream-partial-output` for `--print --output-format stream-json`.
  - External wrappers/examples also pass `--stream-partial-output`:
    - https://pypi.org/project/cursor-cli/ (links to `veictry/cursor-cli`)
    - https://docs.praison.ai/docs/code/cursor-cli

---
id: "8461"
status: closed
deps: [8ea4]
links: []
created: 2026-02-15T19:46:12Z
type: task
priority: 3
---
# Configurable preamble: move COUNCIL_PREAMBLE to config

## Context

The hardcoded `COUNCIL_PREAMBLE` restricts agents to read-only advisory. For the "best engineers" chat experience, users should be able to customize this via `council.preamble` in config.json.

## Acceptance Criteria

- [x] `CouncilMember.build_command()` reads preamble from `council.preamble` config instead of hardcoded `COUNCIL_PREAMBLE`
- [x] Default value matches current `COUNCIL_PREAMBLE` text (backward compatible)
- [x] Per-agent `agents.<name>.prompts.council` remains additive (appended after preamble), not a replacement
- [x] Prompt merge order: preamble + phase prompt + agent prompt + user prompt
- [x] Existing council behavior unchanged when `council.preamble` is not set in config
- [x] Test: custom preamble propagates into the built command's prompt

## Worklog

- 2026-02-16: Plumbing already existed: `CouncilConfig.preamble`, `CouncilMember.preamble` field, `build_command()` using `self.preamble or self.COUNCIL_PREAMBLE`. Missing link: `Council.create()` wasn't passing `cfg.council.preamble` to members.
- 2026-02-16: One-line fix in `council.py`: pass `preamble=cfg.council.preamble` when constructing `CouncilMember`.
- 2026-02-16: Added 3 tests: `test_create_passes_council_preamble`, `test_create_default_preamble_is_empty`, `test_create_preamble_used_in_build_command`.

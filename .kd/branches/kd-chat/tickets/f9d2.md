---
id: "f9d2"
status: closed
deps: []
links: []
created: 2026-02-15T19:46:03Z
type: task
priority: 1
---
# Store Popen handle on CouncilMember and write PID to AgentState

## Context

`query_once()` currently runs subprocess internally and doesn't expose the Popen handle. The TUI needs direct access to terminate subprocesses on Escape. Also, writing PID to AgentState enables external monitoring if the TUI crashes.

## Acceptance Criteria

- [ ] `CouncilMember` has `self.process: subprocess.Popen | None = None` field
- [ ] `query_once()` sets `self.process = proc` immediately after `Popen()` call
- [ ] `query_once()` calls `update_agent_state(..., pid=proc.pid)` immediately after `Popen()`
- [ ] `self.process` is reset to `None` after process completes (success or failure)
- [ ] External code can call `member.process.terminate()` while query is running
- [ ] Existing council tests pass; process handle doesn't break existing flows
